<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE configuration>
<configuration>
    <appender name="stdout" class="ch.qos.logback.core.ConsoleAppender">
        <encoder name="enc" class="ch.qos.logback.core.encoder.LayoutWrappingEncoder">
            <layout class="orgarif.utils.logback.LogbackPatternLayout">
                <!-- @formatter:off -->
                <pattern>%d{MM-dd HH:mm:ss} %highlight(%-5level) %cyan(%-36logger{36}) %m %magenta(%userSession){}%blue(%ip){}%n</pattern>
                <!-- @formatter:on -->
            </layout>
        </encoder>
    </appender>

    <property name="LOG_TO_FILE" value="${LOG_TO_FILE:-true}"/>

    <if condition='"${LOG_TO_FILE}" == "true"'>
        <then>
            <appender name="fileAppender" class="ch.qos.logback.core.rolling.RollingFileAppender">
                <file>/var/log/orgarif/orgarif.log</file>
                <rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy">
                    <fileNamePattern>/var/log/orgarif/orgarif-%d{yyyy-MM-dd}.log</fileNamePattern>
                </rollingPolicy>
                <encoder class="ch.qos.logback.core.encoder.LayoutWrappingEncoder">
                    <layout class="orgarif.utils.logback.LogbackPatternLayout">
                        <pattern>%d{yyyy-MM-dd HH:mm:ss} %-5level %-36logger{36} %m %userSession{}%ip{}%n</pattern>
                    </layout>
                </encoder>
            </appender>
        </then>
    </if>

    <root level="WARN">
        <appender-ref ref="stdout"/>
        <if condition='"${LOG_TO_FILE}" == "true"'>
            <then>
                <appender-ref ref="fileAppender"/>
            </then>
        </if>
    </root>

    <logger name="orgarif" level="INFO"/>

    <logger name="orgarif.error.ApplicationExceptionHandlerExceptionResolver" level="WARN"/>
    <!-- Spring noise -->
    <logger name="org.spring.aop.framework.CglibAopProxy" level="INFO"/>
</configuration>
